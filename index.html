<!DOCTYPE html>
<html>

<head>
    <title>Check-in</title>
    <style>
        body {
          font-family: Arial, sans-serif;
          background-color: #f4f4f4;
          margin: 0;
          padding: 20px;
        }

        form {
          background-color: #fff;
          padding: 20px;
          max-width: 600px;
          margin: 0 auto;
        }

        input[type="text"],
        input[type="date"],
        select {
          width: 100%;
          padding: 12px 20px;
          margin: 8px 0;
          box-sizing: border-box;
          border: 1px solid #ccc;
          border-radius: 4px;
          resize: vertical;
        }

        input[type="submit"] {
          background-color: #4CAF50;
          color: white;
          padding: 12px 20px;
          border: none;
          border-radius: 4px;
          cursor: pointer;
        }

        input[type="submit"]:hover {
          background-color: #45a049;
        }

        label {
          padding: 12px 12px 12px 0;
          display: inline-block;
        }

        .container {
          border-radius: 5px;
          background-color: #f2f2f2;
          padding: 20px;
        }

        .success {
          background-color: #dff0d8;
          border-color: #d6e9c6;
          color: #3c763d;
          padding: 10px;
          margin-bottom: 20px;
        }

        .error {
          background-color: #f2dede;
          border-color: #ebccd1;
          color: #a94442;
          padding: 10px;
          margin-bottom: 20px;
        }

        .error ul {
          margin: 0;
          padding: 0;
        }

        .error li {
          list-style: none;
        }

        .error li:before {
          content: 'âœ˜ ';
        }

        .error li {
          margin-left: 20px;
        }

        

      </style>      
</head>

<body>
    <form id="checkin-form">
        <label for="date">Date:</label>
        <input type="date" id="date" name="date" readonly><br>
        <label for="classroom">Classroom Number:</label>
        <input type="text" id="classroom" name="classroom" readonly><br>
        <label for="teacher-name">Teacher's Name:</label>
        <input type="text" id="teacher-name" name="teacher-name"><br>
        <label for="action">Action:</label>
        <select id="action" name="action">
            <option value="check-in">Check-In</option>
            <option value="check-out">Check-Out</option>
        </select><br>
        <input type="submit" value="Submit">
    </form>

    <script>
        // Get the classroom number from the query parameter
        var urlParams = new URLSearchParams(window.location.search);
        var classroom = urlParams.get('classroom');

        // Fill the classroom input field and current date
        document.getElementById('classroom').value = classroom;
        var now = new Date();
        document.getElementById('date').valueAsDate = now;

        document.getElementById('checkin-form').addEventListener('submit', function (event) {
            event.preventDefault();

            // Gather form data
            var formData = {
                date: document.getElementById('date').value,
                classroom: document.getElementById('classroom').value,
                teacherName: document.getElementById('teacher-name').value,
                action: document.getElementById('action').value
            };

            // Determine the time field based on the action
            var timeField = formData.action === 'check-in' ? 'timeIn' : 'timeOut';
            formData[timeField] = now.toTimeString().slice(0, 5);

            // Send data to Google Apps Script
            var queryString = Object.keys(formData).map(key => key + '=' + formData[key]).join('&');
            fetch('https://script.google.com/macros/s/AKfycbzXANdja04PzW8zyvug0l0RxAqvMfl5Gy3dI70mHvQ6ANX5ZDD72zzYkCdnbyvJ0uVOQQ/exec' + '?' + queryString)
                .then(response => response.json())
                .then(data => {
                    alert('Action successful!');
                    // Handle success, maybe redirect or clear the form
                })
                .catch(error => {
                    alert('An error occurred. Please try again.');
                    // Handle error
                });

        });
    </script>
</body>

</html>